(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c25e"],{ZySA:function(e,t,a){"use strict";var n=a("P2sY"),l=a.n(n),i=(a("jUE0"),{bind:function(e,t){e.addEventListener("click",function(a){var n=l()({},t.value),i=l()({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},n),o=i.ele;if(o){o.style.position="relative",o.style.overflow="hidden";var s=o.getBoundingClientRect(),r=o.querySelector(".waves-ripple");switch(r?r.className="waves-ripple":((r=document.createElement("span")).className="waves-ripple",r.style.height=r.style.width=Math.max(s.width,s.height)+"px",o.appendChild(r)),i.type){case"center":r.style.top=s.height/2-r.offsetHeight/2+"px",r.style.left=s.width/2-r.offsetWidth/2+"px";break;default:r.style.top=(a.pageY-s.top-r.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",r.style.left=(a.pageX-s.left-r.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return r.style.backgroundColor=i.color,r.className="waves-ripple z-active",!1}},!1)}}),o=function(e){e.directive("waves",i)};window.Vue&&(window.waves=i,Vue.use(o)),i.install=o;t.a=i},jUE0:function(e,t,a){},xUov:function(e,t,a){"use strict";a.r(t);var n=a("t3Un");var l=a("ZySA"),i=(a("7Qib"),{directives:{waves:l.a},filters:{statusFilter:function(e){return{published:"success",draft:"gray",deleted:"danger"}[e]}},data:function(){return{channel_value:"",channelList:[],average:{one:0,three:0,seven:0,fourteen:0,thirty:0,lt:"0"},fullscreenLoading:!1,options:"",select_value:"",pickerOptions0:{disabledDate:function(e){return e.getTime()>Date.now()-864e4}},directives:{waves:l.a},downloadLoading:!1,layout:"",timevalue:"",searchName:"搜索",tableKey:0,list:[],total:0,listLoading:!1,listQuery:{importance:void 0,title:void 0,type:void 0},listParam:{start:"",end:"",name:"",appkey:"",channel:""},importanceOptions:[1,2,3],names:[],sortOptions:[{label:"ID Ascending",key:"+id"},{label:"ID Descending",key:"-id"}],statusOptions:["published","draft","deleted"]}},mounted:function(){this.initapps()},methods:{changeselect:function(){var e=this,t=this;(function(e){return Object(n.a)({url:"/umengchannels/"+e,method:"get"})})(this.select_value.appkey).then(function(t){e.channelList=t.data.data;e.channelList=[{id:"全部",channel:"全部"}].concat(e.channelList),e.channel_value="全部",console.log(e.channelList)}).catch(function(e){t.$notify({title:"初始化app列表",message:"刷新试试",type:"error",duration:2e3})})},initapps:function(){var e=this,t=this;t.fullscreenLoading=!0,Object(n.a)({url:"/umengapp",method:"get"}).then(function(a){e.options=a.data.data,t.fullscreenLoading=!1}).catch(function(e){t.$notify({title:"初始化app列表",message:"刷新试试",type:"error",duration:2e3}),t.fullscreenLoading=!1})},handleFilter:function(){var e=this;this.list=[];var t=this;if(this.downloadLoading=!0,""===this.timevalue||null==this.timevalue||"undefined"===this.timevalue[0]||"undefined"===this.timevalue[1]||""===this.select_value)return this.$message({message:"记得选择查询范围~",type:"warning"}),void(this.downloadLoading=!1);var a=new Date(this.timevalue[0]).getTime();if(new Date(this.timevalue[1]).getTime()-a>2592e6)return t.$notify({title:"",message:"时间范围最多选择30天",type:"warning",duration:2e3}),void(this.downloadLoading=!1);this.listParam.start=this.timevalue[0],this.listParam.end=this.timevalue[1],this.listParam.name=this.select_value.name,this.listParam.appkey=this.select_value.appkey,this.listParam.channel=this.channel_value,this.listLoading=!0,function(e){return Object(n.a)({url:"/umengretention",method:"post",data:e})}(this.listParam).then(function(t){console.log(t.data.data);for(var a=t.data.data,n=0,l=0,i=0,o=0,s=0,r=0;r<a.length;r++){var c=a[r].install_period,d=a[r].retention_rate,u=void 0===d[0]?0:d[0],p=void 0===d[1]?0:d[1],v=void 0===d[2]?0:d[2],h=void 0===d[3]?0:d[3],f=void 0===d[4]?0:d[4],g=void 0===d[5]?0:d[5],_=void 0===d[6]?0:d[6],m=void 0===d[7]?0:d[7],y=void 0===d[8]?0:d[8],w={date:c,oneDay:u,twoDay:p,threeDay:v,fourDay:h,fiveDay:f,sixDay:g,sevenDay:_,halfmonth:m,onemonth:y,lt:((1.5*(v+_)+3*(_+m)+7.5*(m+y)+u+v+_+m+y)/u*u/100+1).toFixed(4)};n+=u,l+=v,i+=_,o+=m,s+=y,e.list.push(w)}var b=n/a.length,k=l/a.length,L=i/a.length,x=o/a.length,D=s/a.length;e.average={one:(n/a.length).toFixed(2),three:(l/a.length).toFixed(2),seven:(i/a.length).toFixed(2),fourteen:(o/a.length).toFixed(2),thirty:(s/a.length).toFixed(2),lt:((1.5*(k+L)+3*(L+x)+7.5*(x+D)+b+k+L+x+D)/b*b/100+1).toFixed(4)},e.listLoading=!1,e.downloadLoading=!1}).catch(function(e){console.error(e),t.listLoading=!1,t.downloadLoading=!1})},setretention:function(e,t){for(var a=0;a<t.length;a++){var n=t[a].channelName,l=t[a].list;if(e.channel===n)for(var i=0;i<l.length;i++)if(l[i].install_period===e.date)return e.total_install=l[i].retention_rate[0],console.log(e),e.total_install_rate=0,e}return e.total_install=0,e.total_install_rate=0,e},handleDownload:function(){var e=this;if(this.downloadLoading=!0,null===this.list)return this.$message({message:"没有信息可以打印~",type:"warning"}),void(this.downloadLoading=!1);Promise.all([a.e("chunk-0d49"),a.e("chunk-92a3")]).then(a.bind(null,"S/jZ")).then(function(t){var a=e.formatJson(["date","id","channel","install","active_user","launch","duration","total_install","total_install_rate"],e.list);t.export_json_to_excel({header:["时间","应用名","渠道","新增人数","活跃人数","启动次数","单次启动时长","次日留存率","版本"],data:a,filename:"友盟3"}),e.downloadLoading=!1})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})},formatDate:function(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var n in a)if(new RegExp("("+n+")").test(t)){var l=a[n]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?l:this.padLeftZero(l))}return t},padLeftZero:function(e){return("00"+e).substr(e.length)}}}),o=a("KHd+"),s=Object(o.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container",staticStyle:{margin:"15px","margin-top":"-5px"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions0},model:{value:e.timevalue,callback:function(t){e.timevalue=t},expression:"timevalue"}},[e._v(">\n    ")]),e._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择应用","value-key":"name"},on:{change:e.changeselect},model:{value:e.select_value,callback:function(t){e.select_value=t},expression:"select_value"}},e._l(e.options,function(t){return a("el-option",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],key:t.appkey,attrs:{label:t.name,value:t}})})),e._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择渠道","value-key":"id"},model:{value:e.channel_value,callback:function(t){e.channel_value=t},expression:"channel_value"}},e._l(e.channelList,function(t){return a("el-option",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],key:t.id,attrs:{label:t.channel,value:t.id}})})),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(e._s(e.searchName)+"\n    ")]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("\n      "+e._s("下载")+"\n    ")])],1),e._v(" "),a("el-card",{staticStyle:{"margin-bottom":"10px"},attrs:{shadow:"always"}},[a("el-tag",[e._v("统计数据(平均值)")]),e._v(" "),a("el-tag",{attrs:{type:"success"}},[e._v("次日留存："+e._s(e.average.one))]),e._v(" "),a("el-tag",{attrs:{type:"success"}},[e._v("三日留存："+e._s(e.average.three))]),e._v(" "),a("el-tag",{attrs:{type:"success"}},[e._v("七日留存："+e._s(e.average.seven))]),e._v(" "),a("el-tag",{attrs:{type:"success"}},[e._v("十四日留存："+e._s(e.average.fourteen))]),e._v(" "),a("el-tag",{attrs:{type:"success"}},[e._v("三十日留存："+e._s(e.average.thirty))]),e._v(" "),a("el-tag",{attrs:{type:"success"}},[e._v("生命周期："+e._s(e.average.lt))])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{height:"850",data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"ID",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(++t.$index)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"时间",width:"110",align:"center",prop:"date"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.date))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"次日留存",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.oneDay))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"二日留存",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.twoDay))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"三日留存",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.threeDay))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"四日留存",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fourDay))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"五日留存",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fiveDay))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"六日留存",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.sixDay))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"七日留存",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.sevenDay))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"十四日留存",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.halfmonth))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"三十日留存",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.onemonth))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"生命周期(lt)",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.lt))])]}}])})],1)],1)},[],!1,null,null,null);s.options.__file="umengLifeTime.vue";t.default=s.exports}}]);