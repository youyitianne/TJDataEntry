(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3af4"],{"3bk7":function(t,e,a){},EM9Q:function(t,e,a){"use strict";var i=a("3bk7");a.n(i).a},PIke:function(t,e,a){"use strict";a.r(e);a("X4fA");var i=a("t3Un");var o={components:{"remote-js":{render:function(t){return t("script",{attrs:{type:"text/javascript",src:this.src}})},props:{src:{type:String,required:!0}}}},name:"DropzoneDemo",data:function(){return{def_currentpage:1,search_currentpage:1,testModeLoading:!1,search_totalPages:0,def_paging:!0,search_paging:!1,ipDialogLoading:!1,searchDialog:!1,pageSize:20,totalPages:0,ipDialog:!1,fetchForm:{appName:"",uid:"",packageName:""},ipForm:{orginalIP:"",loaclIP:""},testModeForm:{id:0,uid:"",appName:"",packageName:"",channel:"",mode:"",ad:""},editDialog:!1,tableData:[]}},mounted:function(){this.initTable()},methods:{searchAppList:function(t){var e=this;(function(t){return Object(i.a)({url:"/api/system/searchapp",method:"post",data:t})})({appName:this.fetchForm.appName,appId:this.fetchForm.uid,appPackageName:this.fetchForm.packageName,page:t,limit:this.pageSize}).then(function(t){var a=JSON.parse(t.data);console.log(a),e.tableData=a.rows,e.search_totalPages=a.total}).catch(function(t){e.$message({message:"搜索失败！",type:"warning"})})},search_pageChange:function(t){this.def_currentpage=t,this.searchAppList(t)},searchData:function(){this.searchAppList(1),this.def_paging=!1,this.search_paging=!0,this.searchDialog=!1},pageChange:function(t){this.def_currentpage=t,this.listapplist(t)},ipEdit:function(){var t=this;this.ipDialogLoading=!0,this.ipDialog=!0,this.ipForm.loaclIP=returnCitySN.cip,function(t){return Object(i.a)({url:"/api/system/getip",method:"post",data:t})}().then(function(e){var a=JSON.parse(e.data);t.ipForm.orginalIP=a.data.ip,t.ipDialogLoading=!1}).catch(function(e){t.$message({message:"获取原IP失败！",type:"warning"}),t.ipDialogLoading=!1})},synchro:function(){var t=this;if(1!=this.ipDialogLoading){this.ipDialogLoading=!0;var e=this;(function(t){return Object(i.a)({url:"/api/system/postip",method:"post",data:t})})({ip:this.ipForm.loaclIP}).then(function(a){3e3==a.repcode?(e.$notify({title:"提示",message:"修改IP成功",type:"success"}),t.ipDialogLoading=!1,t.ipDialog=!1):(e.$notify({title:"提示",type:"warning",message:"修改IP失败"}),t.ipDialogLoading=!1)}).catch(function(e){t.$message({message:"修改IP失败！",type:"warning"})})}},onSubmit:function(){var t=this;if(1!=this.testModeLoading){this.testModeLoading=!0;var e=this,a={appId:this.testModeForm.id,system:"test",status:{mode:this.testModeForm.mode,ad:this.testModeForm.ad}};console.log(a),function(t){return Object(i.a)({url:"/api/system/editparams",method:"post",data:t})}(a).then(function(a){3e3==a.repcode?(e.$notify({title:"提示",message:"修改测试模式成功",type:"success"}),t.testModeLoading=!1,t.editDialog=!1):(e.$notify({title:"提示",type:"warning",message:"修改测试模式失败"}),t.testModeLoading=!1),t.flushList()}).catch(function(a){console.error(a),e.$notify({title:"提示",type:"warning",message:"修改测试模式失败"}),t.testModeLoading=!1})}},initTable:function(){this.listapplist(1)},edit:function(t){var e=this;this.testModeLoading=!0;var a=this;this.testModeForm.mode="off",this.testModeForm.ad="off",this.testModeForm.uid=t.uid,this.testModeForm.appName=t.appName,this.testModeForm.packageName=t.packageName,this.testModeForm.channel=t.channel,function(t){return Object(i.a)({url:"/api/system/getparams",method:"post",data:t})}({appId:t.uid}).then(function(o){var s=JSON.parse(o.data).rows;console.log(s);for(var r={},n=0,l=!0,c=0;c<s.length;c++)if("test"==s[c].system){l=!1,r=s[c].status,n=s[c].id;break}if(l){var p={appId:t.uid,system:"test",status:{mode:"off",ad:"off"}};a.$notify({title:"提示",type:"warning",message:"该应用无测试模式,正在添加默认测试模式-----"}),function(t){return Object(i.a)({url:"/api/system/addparams",method:"post",data:t})}(p).then(function(i){3e3==i.repcode?(a.$notify({title:"提示",message:"添加默认测试模式成功,请重新编辑测试模式",type:"success"}),e.edit(t)):a.$notify({title:"提示",type:"warning",message:"添加默认测试模式失败,刷新试试"}),e.flushList()}).catch(function(t){console.error(t),a.$notify({title:"提示",type:"warning",message:"添加默认测试模式失败,刷新试试"})})}else{var d=JSON.parse(r);e.testModeForm.mode=d.mode,e.testModeForm.ad=d.ad,e.testModeForm.id=n,e.testModeLoading=!1,e.editDialog=!0}}).catch(function(t){console.error(t),e.$message({message:"获取应用参数失败！",type:"warning"})})},listapplist:function(t){var e=this;(function(t){return Object(i.a)({url:"/api/system/getapplist",method:"post",data:t})})({page:t,limit:this.pageSize}).then(function(t){var a=JSON.parse(t.data);e.tableData=a.rows,e.totalPages=a.total}).catch(function(t){e.$message({message:"初始化表格失败！",type:"warning"})})},flushList:function(){this.def_paging?this.pageChange(this.def_currentpage):this.search_pageChange(this.def_currentpage)}}},s=(a("EM9Q"),a("KHd+")),r=Object(s.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"components-container"},[a("el-button",{staticStyle:{margin:"20px"},attrs:{type:"danger"},on:{click:function(e){t.ipEdit()}}},[t._v("同步IP")]),t._v(" "),a("el-dialog",{attrs:{title:"IP同步",visible:t.ipDialog,width:"30%"},on:{"update:visible":function(e){t.ipDialog=e}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.ipDialogLoading,expression:"ipDialogLoading"}],ref:"ipForm",attrs:{model:t.ipForm,"label-width":"200px"}},[a("el-form-item",{attrs:{label:"原保存IP : "}},[a("el-input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:t.ipForm.orginalIP,callback:function(e){t.$set(t.ipForm,"orginalIP",e)},expression:"ipForm.orginalIP"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"本地IP : "}},[a("el-input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:t.ipForm.loaclIP,callback:function(e){t.$set(t.ipForm,"loaclIP",e)},expression:"ipForm.loaclIP"}})],1)],1),t._v(" "),a("el-button",{staticStyle:{"margin-left":"60%"},attrs:{type:"primary"},on:{click:t.synchro}},[t._v("同步")])],1),t._v(" "),a("el-button",{staticStyle:{margin:"20px"},attrs:{type:"primary"},on:{click:function(e){t.searchDialog=!0}}},[t._v("搜索应用")]),t._v(" "),a("el-dialog",{attrs:{title:"搜索应用",visible:t.searchDialog,width:"30%"},on:{"update:visible":function(e){t.searchDialog=e}}},[a("el-form",{ref:"fetchForm",attrs:{model:t.fetchForm,"label-width":"200px"}},[a("el-form-item",{attrs:{label:"应用名 : "}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:t.fetchForm.appName,callback:function(e){t.$set(t.fetchForm,"appName",e)},expression:"fetchForm.appName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"屏蔽key : "}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:t.fetchForm.uid,callback:function(e){t.$set(t.fetchForm,"uid",e)},expression:"fetchForm.uid"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"包名 : "}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:t.fetchForm.packageName,callback:function(e){t.$set(t.fetchForm,"packageName",e)},expression:"fetchForm.packageName"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.searchData}},[t._v("搜索")])],1)],1),t._v(" "),a("el-card",{attrs:{shadow:"always"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{height:"730",border:"",data:t.tableData}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"appName",label:"应用名",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"uid",label:"屏蔽key",width:"300"}}),t._v(" "),a("el-table-column",{attrs:{prop:"packageName",label:"应用包名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"channel",label:"渠道"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.edit(e.row)}}},[t._v("测试模式")])]}}])})],1),t._v(" "),t.def_paging?a("el-pagination",{attrs:{"page-size":t.pageSize,layout:"prev, pager, next",total:t.totalPages,"current-page":t.def_currentpage},on:{"current-change":t.pageChange}}):t._e(),t._v(" "),t.search_paging?a("el-pagination",{attrs:{"page-size":t.pageSize,layout:"prev, pager, next",total:t.search_totalPages,"current-page":t.search_currentpage},on:{"current-change":t.search_pageChange}}):t._e()],1),t._v(" "),a("el-dialog",{attrs:{title:"测试模式",visible:t.editDialog,width:"30%"},on:{"update:visible":function(e){t.editDialog=e}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.testModeLoading,expression:"testModeLoading"}],ref:"testModeForm",attrs:{model:t.testModeForm,"label-width":"200px"}},[a("el-form-item",{attrs:{label:"屏蔽key : "}},[a("el-input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:t.testModeForm.uid,callback:function(e){t.$set(t.testModeForm,"uid",e)},expression:"testModeForm.uid"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"应用名 : "}},[a("el-input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:t.testModeForm.appName,callback:function(e){t.$set(t.testModeForm,"appName",e)},expression:"testModeForm.appName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"应用包名 : "}},[a("el-input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:t.testModeForm.packageName,callback:function(e){t.$set(t.testModeForm,"packageName",e)},expression:"testModeForm.packageName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"渠道 : "}},[a("el-input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:t.testModeForm.channel,callback:function(e){t.$set(t.testModeForm,"channel",e)},expression:"testModeForm.channel"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"测试模式 : "}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"on","inactive-value":"off"},model:{value:t.testModeForm.mode,callback:function(e){t.$set(t.testModeForm,"mode",e)},expression:"testModeForm.mode"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"广告开关 : "}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"on","inactive-value":"off"},model:{value:t.testModeForm.ad,callback:function(e){t.$set(t.testModeForm,"ad",e)},expression:"testModeForm.ad"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确定修改")])],1)],1),t._v(" "),a("remote-js",{attrs:{src:"http://pv.sohu.com/cityjson?ie=utf-8"}})],1)},[],!1,null,"9d02ff8c",null);r.options.__file="testmode.vue";e.default=r.exports}}]);